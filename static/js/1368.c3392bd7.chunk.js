"use strict";(self.webpackChunkmy_assignment=self.webpackChunkmy_assignment||[]).push([[1368],{31368:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(61712),s=n(80808),i=n(67424),a=n(36844),o=n(12008),u=n(79064),l=n(87208),c=n(73384),h=n(26210),p=n(14608),y=n(70661),d=n(11860),g=n(1336),f=n(31600);class m{constructor(){this._queryEngine=null,this._customParameters=null}destroy(){var e;null!==(e=this._queryEngine)&&void 0!==e&&e.destroy(),this._queryEngine=null}async load(e,t){const{getFeatureUrl:n,getFeatureOutputFormat:r,fields:i,geometryType:o,featureType:u,objectIdField:p,customParameters:y}=e,{spatialReference:m,getFeatureSpatialReference:_}=(0,d.i4)(n,u,e.spatialReference);this._featureType=u,this._customParameters=y,this._getFeatureUrl=n,this._getFeatureOutputFormat=r,this._getFeatureSpatialReference=_;try{await(0,c.Qv)(_,m)}catch{throw new s.c("unsupported-projection","Projection not supported",{inSpatialReference:_,outSpatialReference:m})}(0,a.wp)(t);const w=g.c.fromLayerJSON({fields:i,dateFieldsTimeReference:i.some((e=>"esriFieldTypeDate"===e.type))?{timeZoneIANA:f.Gw}:null}),F=await this._snapshotFeatures({fieldsIndex:w,geometryType:o,objectIdField:p,spatialReference:m},t.signal);return this._queryEngine=new h.U({fieldsIndex:w,geometryType:o,hasM:!1,hasZ:!1,objectIdField:p,spatialReference:m,timeInfo:null,featureStore:new l.c({geometryType:o,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(F),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new s.c("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(e){var t;return this._customParameters=e,null!==(t=this._snapshotTask)&&void 0!==t&&t.abort(),this._snapshotTask=(0,r.kn)((e=>this._snapshotFeatures(this._queryEngine,e))),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(e=>{this._queryEngine.featureStore.clear(),(0,a.mA)(e)||i.c.getLogger("esri.layers.WFSLayer").error(new s.c("wfs-layer:getfeature-error","An error occurred during the GetFeature request",{error:e}))})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(e,t){var n;let{objectIdField:r,geometryType:s,spatialReference:i,fieldsIndex:l}=e;const h=await(0,d.Az)(null!==(n=this._getFeatureUrl)&&void 0!==n?n:"",this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:t});(0,p.ii)(h,this._getFeatureSpatialReference.wkid),(0,a.wp)(t);const g=(0,p.MN)(h,{geometryType:s,hasZ:!1,objectIdField:r});if(!(0,o.yK)(i,this._getFeatureSpatialReference))for(const a of g)null!=a.geometry&&(a.geometry=(0,u.C)((0,c.yU)((0,u.qw)(a.geometry,s,!1,!1),this._getFeatureSpatialReference,i)));let f=1;for(const a of g){const e={};(0,y.uo)(l,e,a.attributes,!0),a.attributes=e,null==e[r]&&(a.objectId=e[r]=f++)}return g}}},70661:(e,t,n)=>{n.d(t,{GI:()=>c,OM:()=>g,Oo:()=>f,or:()=>u,uo:()=>p});var r=n(36408),s=n(12008),i=n(74540);class a{constructor(){this.code=null,this.description=null}}class o{constructor(e){this.error=new a,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function u(e){return new o(e)}class l{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function c(e){return new l(e)}const h=new Set;function p(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];h.clear();for(const a in n){const s=e.get(a);if(!s)continue;const o=y(s,n[a]);if(h.add(s.name),s&&(r||s.editable)){const e=(0,i.YT)(s,o);if(e)return u((0,i.Ke)(e,s,o));t[s.name]=o}}for(const i of null!==(s=null===e||void 0===e?void 0:e.requiredFields)&&void 0!==s?s:[]){var s;if(!h.has(i.name))return u('missing required field "'.concat(i.name,'"'))}return null}function y(e,t){let n=t;return(0,i.iW)(e)&&"string"==typeof t?n=parseFloat(t):(0,i.AZ)(e)&&null!=t&&"string"!=typeof t?n=String(t):(0,i.gp)(e)&&"string"==typeof t&&(n=(0,r.sn)(t)),(0,i.OJ)(n)}let d;function g(e,t){if(!e||!(0,s.U3)(t))return e;if("rings"in e||"paths"in e){if(null==d)throw new TypeError("geometry engine not loaded");return d.simplify(t,e)}return e}async function f(e,t){!(0,s.U3)(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await async function(){return null==d&&(d=await Promise.all([n.e(5104),n.e(4092)]).then(n.bind(n,46472))),d}()}}}]);
//# sourceMappingURL=1368.c3392bd7.chunk.js.map